/*
 * jQuery Render Plugin v1.0pre
 * Optimized version of jQuery Templates, for rendering to string
 * http://github.com/BorisMoore/jsrender
 */
(function(a){var u=a.fn.domManip,h=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,j=0,k=[],p=0,n="$view.calls($view,__,$1,$2);__=[];",m=["call=$view.calls();__=call[1].concat($view.","(call,__));"];function c(d,b,f,g){var c=this,e=!!a.view||(b||d).annotate;c.parent=b||null;b=b||{};d.path=d.path||"~";a.extend(c,d,{data:g||b.data||{},annotate:e,tmpl:f||null,_wrap:b._wrap});if(f){content=c.tmpl(a,c);c._ctnt=e&&a.isArray(b.data)?[].concat("<!--item-->",content,"<!--/item-->"):content;c.key=++j}}a.fn.extend({render:function(d,c,b){return a.render(this[0],d,c,b)},template:function(c,b){return a.template(c,this[0],b)}});a.extend({render:function(d,c,b,a){var e=l(d,c,b,a);j=0;return e},template:function(c,b){if(b){if(typeof b==="string")b=f(b);else if(b instanceof a)b=b[0]||null;if(b&&b.nodeType)b=a.data(b,"tmpl")||a.data(b,"tmpl",f(b.innerHTML));b._name=b._name||"_"+p++;return a.template[b._name]=b}return c?typeof c!=="string"?a.template(null,c):a.template[c]||a.template(null,h.test(c)?c:a(c)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")},tmplSettings:{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($view.nest($1,$2s,$2));}"},wrap:{_default:{$2:"null"},open:n,close:m.join("wrap")},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},":":{open:"$1"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},view:{tmpl:null,nodes:[],calls:function(a){if(!a)return k.pop();k.push(arguments)},nest:function(e,c,d,b){b=b||{};b.path=c;var f=g(a.template(e),d,b,this);return f},wrap:function(b,d){var c=b[4]||{};c.wrapped=d;return a.render(a.template(b[2]),b[3],c,b[0])},html:function(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||o(a)})}}}});var q=a.tmplSettings.tag,s=a.template(null,"{{html this.html()}}");c.prototype=a.tmplSettings.view;function l(b,f,e,a){var c=g(b,f,e,a);return a&&b?c:d(a,c).join("")}function g(f,g,b,d){b=b||{};b.annotate=b.annotate||!!a.view;var i,h,j=!d;if(j){if(!a.isFunction(f))f=a.template[f]||a.template(null,f)}else if(!f){f=d.tmpl;d.nodes=[];d.wrapped&&e(d,d.wrapped);return d.tmpl(a,d)}if(!f)return null;if(typeof g==="function")g=g.call(d||{});if(b.wrapped){e(b,b.wrapped);if(b.addIds){f=a.template(null,b._wrap);b._wrap=null;b.wrapped=null;delete b.addIds}}if(a.isArray(g)){i=new c(b,d,null,g);h=a.map(g,function(a){b.path="*";return a?new c(b,i,f,a):null})}else h=[new c(b,d,f,g)];return(d||b).annotate?[].concat("<!--tmpl("+(i||h[0]).path+") "+f._name+"-->",h,"<!--/tmpl-->"):h}function d(b,c){var e=b&&b.annotate;return c?a.map(c,function(a){return typeof a==="string"?a:d(a,a._ctnt)}):b}function f(d){var c=/\$\{([^\}]*)\}/g,e="var $=jQuery,call,__=[],$data=$view.data;with($data){__.push('"+a.trim(d).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(c,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*)\))?\s*\}\}/g,function(l,j,k,d,a,c,e){var i=q[k],h,f,g;h=i._default||[];if(c&&!/\w$/.test(a)){a+=c;c=""}if(a){a=b(a);e=e?","+b(e)+")":c?")":"";f=c?a.indexOf(".")>-1?a+b(c):"("+a+").call($view"+e:a;g=c?f:"(typeof("+a+")==='function'?("+a+").call($view):("+a+"))"}else g=f=h.$1||"null";d=b(d);return"');"+i[j?"close":"open"].split("$notnull_1").join(a?"typeof("+a+")!=='undefined' && ("+a+")!=null":"true").split("$1a").join(g).split("$2s").join("'"+d+"'").split("$1").join(f).split("$2").join(d||h.$2||"")+"__.push('";return test})+"');}return __;";return new Function("jQuery","$view",e)}function e(c,b){c._wrap=d(c,a.isArray(b)?b:[h.test(b)?b:a(b).html()]).join("")}function b(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function o(b){var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML}})(jQuery);